<div class="row admin-header-container">    <div class="col-sm">      <h3 class="admin-header-big-text">{__('Galleries')}</h3>      <h3 class="admin-header-small-text">{__('Gestion de Gallerie')}</h3>    </div>    <div class="col-sm" style="padding: 0;">        <div style="float: right;padding-top: 10px;">            {if $user->hasCredential([['superadmin','admin']])}                <a id="New" class="btn btn-success" title="new" href="#" style="border-radius: 0;">                <i class="fa fa-plus" style=" margin-right: 10px;"></i>               {*<img src="{url('/icons/new.gif','picture')}" alt="{__('new')}"/>*}{__('new gallery')|capitalize}            </a>              {/if}        </div>    </div></div>  <div class="page-ticket" style="background-color: white; height: 40px; padding-left: 20px; display: table;    width: 100%; text-align: left; margin-bottom: 15px;">    <p style="display: table-cell; vertical-align: middle; font-size: 0.7em; color: #a9b2bd;">        <i class="fa fa-home" style="color: #37bc9b;"></i>        <i class="fa fa-angle-right" style="margin: 0 5px 0 5px; font-size: 1em;"></i>{__('Media')}        <i class="fa fa-angle-right" style="margin: 0 5px 0 5px; font-size: 1em;"></i>{__('Galleries')}    </p></div>{alerts}<div class="table-responsive bg-white px-2 py-2">                         <div class="col-md-12 padd-col">                   <div>                                    {component name="/site_languages/selectListLanguagesFrontend" selected=$formFilter.lang}             </div>                  <div class="float-left w-50">                       {include file="./_pagers/default/_default_pager_top.tpl" pager=$pager}                    </div>                   <div class="float-right w-50">                                           <button id="filter" class="btn btn-primary" style="float: right; border: 0; border-radius: 0; background-color: #c8c8c8; color:black;">{__("Filter")}</button>                           <button id="init" class="btn btn-primary" style="float: right; margin-right: 10px; border: 0; border-radius: 0; background-color: #c8c8c8; color:black;">{__("Init")}</button>                 </div>             </div>    <table class='table-bordered table-hover table-striped footable table'>         <thead class="bgSpec">            <tr class=" list-header">             <th>#</th>            <th data-hide="phone" style="display: table-cell;">&nbsp;</th>               <th>                 <span>{__('id')}</span>                 <div style="float: right;">                     <a href="#" class="order{$formFilter.order.id->getValueExist('asc','_active')}" id="asc" name="id"><i class="fas fa-sort-up {if $formFilter.order.id->getValue()=='asc'}text-dark{/if}"></i></a>                     <a href="#" class="order{$formFilter.order.id->getValueExist('desc','_active')}" id="desc" name="id"><i class="fas fa-sort-down {if $formFilter.order.id->getValue()=='desc'}text-dark{/if}"></i></a>                 </div>              </th>                           <th>                 <span>{__('Name')}</span>                 <div style="float: right;">                     <a href="#" class="order{$formFilter.order.name->getValueExist('asc','_active')}" id="asc" name="name"><i class="fas fa-sort-up {if $formFilter.order.name->getValue()=='asc'}text-dark{/if}"></i></a>                     <a href="#" class="order{$formFilter.order.name->getValueExist('desc','_active')}" id="desc" name="name"><i class="fas fa-sort-down {if $formFilter.order.name->getValue()=='desc'}text-dark{/if}"></i></a>                 </div>              </th>                          <th>                 <span>{__('Title')}</span>                 <div style="float: right;">                     <a href="#" class="order{$formFilter.order.title->getValueExist('asc','_active')}" id="asc" name="title"><i class="fas fa-sort-up {if $formFilter.order.title->getValue()=='asc'}text-dark{/if}"></i></a>                     <a href="#" class="order{$formFilter.order.title->getValueExist('desc','_active')}" id="desc" name="title"><i class="fas fa-sort-down {if $formFilter.order.title->getValue()=='desc'}text-dark{/if}"></i></a>                 </div>              </th>                       <th style="width: 130px;">                 <span>{__('Active')}</span>             </th>            <th style="width: 230px;" class="footable-first-column" data-toggle="true">                <span>{__('Start At')}</span>                   <div style="float: right;">                    <a href="#" class="position-absolute order{$formFilter.order.start_at->getValueExist('asc','_active')}" id="asc" name="start_at"><i class="fas fa-sort-up {if $formFilter.order.start_at->getValue()=='asc'}text-dark{/if}"></i></a>                    <a href="#" class="position-absolute order{$formFilter.order.start_at->getValueExist('desc','_active')}" id="desc" name="start_at"><i class="fas fa-sort-down {if $formFilter.order.start_at->getValue()=='desc'}text-dark{/if}"></i></a>                           </div>            </th>            <th style="width: 230px;" class="footable-first-column" data-toggle="true">                <span>{__('Expired At')}</span>                   <div style="float: right;">                    <a href="#" class="position-absolute order{$formFilter.order.expired_at->getValueExist('asc','_active')}" id="asc" name="expired_at"><i class="fas fa-sort-up {if $formFilter.order.expired_at->getValue()=='asc'}text-dark{/if}"></i></a>                    <a href="#" class="position-absolute order{$formFilter.order.expired_at->getValueExist('desc','_active')}" id="desc" name="expired_at"><i class="fas fa-sort-down  {if $formFilter.order.expired_at->getValue()=='desc'}text-dark{/if}" ></i></a>                           </div>            </th>                      <th data-hide="phone" style="display: table-cell; background-color: #36bc9a; color: white;">{__('actions')|capitalize}</th>     </tr>      </thead>     <tr>            <td></td>           <td></td>             <td>{* id *}                <input style="height: 35px;" placeholder="id" class="search form-control" type="text" size="5" name="id" value="{$formFilter.search.id}">            </td>                       <td>{* name *}                 <input style="height: 35px;" placeholder="nom" class="search form-control" type="text" size="5" name="name" value="{$formFilter.search.name}">            </td>                        <td>{* title *}               {* {html_options_format class="equal" name="lang" options=$formFilter->equal.lang->getOption('choices') selected=(string)$formFilter.equal.lang} *}            </td>                 <td>{* active *}                {html_options style="height: 31px;" class="equal Select show-menu-arrow form-control" name="is_active" options=$formFilter->equal.is_active->getOption('choices') selected=(string)$formFilter.equal.is_active}            </td>                   <td>{* start *}                        <div class="form-to-form">                   <input placeholder="{__('from')}" class="form-control form-control-sm ml-1 InputTexte RowBlock range Date" id="start_at_from" type="text" size="34" name="start_at[from]" value="{format_date((string)$formFilter.range.start_at.from|default:'','a')}"/>                         <input  placeholder="{__('to')}" class="form-control form-control-sm ml-1 InputTexte RowBlock range Date" id="start_at_to" type="text" size="34" name="start_at[to]" value="{format_date((string)$formFilter.range.start_at.to|default:'','a')}"/>                 </div>             </td>           <td>{* expired *}                         <div class="form-to-form">                   <input placeholder="{__('from')}" class="form-control form-control-sm ml-1 InputTexte RowBlock range Date" id="expired_at_from" type="text" size="34" name="expired_at[from]" value="{format_date((string)$formFilter.range.expired_at.from|default:'','a')}"/>                   <input placeholder="{__('to')}"  class="form-control form-control-sm ml-1 InputTexte RowBlock range Date" id="expired_at_to" type="text" size="34" name="expired_at[to]" value="{format_date((string)$formFilter.range.expired_at.to|default:'','a')}"/>                </div>                        </td>                 <td>{* actions *}           </td>       </tr>            {foreach $pager as $item}        <tr class="galleries list" id="{$item->get('id')}">          <td class="galleries-count">{(($pager->getPage()-1)*$pager->getNbItemsByPage())+$item@iteration}</td>                         <td>                          <input class="selection" type="checkbox" data-id="{if $item->hasI18n()}{$item->getI18n()->get("id")}{/if}" id="{if $item->hasI18n()}{$item->getI18n()->get("title")}{/if} name="{$item->get('id')}"/>               </td>                          <td>{* id *}                 <span>{$item->get('id')|escape}</span>                                  </td>               <td>{* name *}                 <span>{$item->get('name')|escape}</span>                  </td>                           <td>{* title *}                 {if $item->hasI18n()}<span>{$item->getI18n()->get('title')|escape}</span>{else}{__('--- not defined ---')}{/if}                  </td>                                  <td class="align-middle text-center">{* is active *}                <a href="#" class="ChangeIsActive" name="{$item->get('is_active')}" id="{$item->get('id')}"><i class="fa fa-circle text-{if $item->isActive()}success{else}danger{/if}"></i></a>             </td>             </td>             <td style="width: 260px">{* start *}                                <span title="{$item->get('start_at')}" name="start_at">{format_date($item->get('start_at'),"a")}</span>                               </td>             <td style="width: 260px">{* expired *}                                 <span title="{$item->get('expired_at')}" name="expired_at">{format_date($item->get('expired_at'),"a")}</span>                               </td>                     <td> {* actions *}                   <a style="margin-right: 5px;" href="#" title="{__('Edit')}" class="View" id="{$item->get('id')}">                     <i class="fa fa-pencil-alt"></i>                 </a>                     <a style="margin-right: 5px;" href="#" title="{__('Pictures')}" class="Pictures" id="{$item->get('id')}">                                     <i class="fas fa-image"></i>                </a>                                     <a style="margin-right: 5px;" href="javascript:void();" title="{__('Copy')}" class="Copy" id="{$item->get('id')}" name="{if $item->hasI18n()}{$item->getI18n()->get("title")}{else}{__('--- not defined ---')}{/if}">                        <i class="fa fa-copy"></i>                    </a>                                                    <a style="margin-right: 5px;" href="#" title="{__('Delete')}" class="Delete" id="{$item->get('id')}" name="{if $item->hasI18n()}{$item->getI18n()->get("title")}{else}{__('--- not defined ---')}{/if}" >                       <i class="fa fa-trash-alt"></i>                 </a>                                          </td>         </tr>              {/foreach}                                  </table>                    {if !$pager->getNbItems()}           {__("no result")}     {/if}         {include file="./_pagers/default/_default_pager_bottom.tpl" pager=$pager}</div><script type="text/javascript">                          function change(action,selection,value) {               $.each(Array.isArray(selection) ? selection : [selection], function () {                                    $("."+action+"[id="+this+"] i").removeClass('text-'+(value=='YES'?'danger':'success')).addClass('text-'+(value=='YES'?'success':'danger'));                    $("."+action+"[id="+this+"]").attr('name',value);               });       }                                           function getFilterParameters()        {            var params={ filter: {   order : { },                                      range: $(".range").getFilter(),                                                                          equal : { },                                                                                                                                        search: { },                                                                                 nbitemsbypage: $("[name=nbitemsbypage]").val(),                                     lang: $("#SelectListLanguages option:selected").attr('id'),                                      token:'{$formFilter->getCSRFToken()}'                                  }};            if ($(".order_active").attr("name"))                    params.filter.order[$(".order_active").attr("name")] =$(".order_active").attr("id");            $(".search").each(function(id) { params.filter.search[this.name] =this.value; });                                           return params;                          }                function updateFilter()        {                                 return $.ajax2({ data: getFilterParameters(), url:"{url_to('site_gallery_ajax',['action'=>'ListPartialGallery'])}" , target: "#actions" });        }                                             var dates = $( "#start_at_from, #start_at_to" ).datepicker({			onSelect: function( selectedDate ) {				var option = this.id == "start_at_from" ? "minDate" : "maxDate",					instance = $( this ).data( "datepicker" ),					date = $.datepicker.parseDate(						instance.settings.dateFormat ||						$.datepicker._defaults.dateFormat,						selectedDate, instance.settings );				dates.not( this ).datepicker( "option", option, date );			}		});                                                            var dates = $( "#expired_at_from, #expired_at_to" ).datepicker({			onSelect: function( selectedDate ) {				var option = this.id == "expired_at_from" ? "minDate" : "maxDate",					instance = $( this ).data( "datepicker" ),					date = $.datepicker.parseDate(						instance.settings.dateFormat ||						$.datepicker._defaults.dateFormat,						selectedDate, instance.settings );				dates.not( this ).datepicker( "option", option, date );			}		});                                                                                              $('.order').click(function() {                $(".order_active").attr('class','order');                $(this).attr('class','order_active');                return updateFilter();            });            $(".search").keypress(function(event) {                if (event.keyCode != 13) return ;                updateFilter();            });                        $("[name=nbitemsbypage],[name=is_active],#filter").change(function() { return updateFilter(); });                                     $("#init").click(function() {                               return $.ajax2({ url:"{url_to('site_gallery_ajax',['action'=>'ListPartialGallery'])}",target: "#actions"});             });             $(".pager").click(function () {                                               return $.ajax2({ data: getGalleriesFilterParameters(),                                  url:"{url_to('site_gallery_ajax',['action'=>'ListPartialGallery'])}?page="+$(this).attr('data-page'),                                       target: "#action"});            });                        $("#SelectListLanguages").change(function() {  updateFilter();   });            $("#all").click(function () {  $(".selection").attr("checked",($(this).attr("checked")=="checked"));  });                     $(".View").click( function () {                                  return $.ajax2({ data : { SiteGalleryI18n : {                                                 gallery_id: this.id,                                                lang: $("#SelectListLanguages option:selected").attr('id'),                                                                                      } },                                url:"{url_to('site_gallery_ajax',['action'=>'ViewGalleryI18n'])}",                                target: "#actions"});            });                         $(".Pictures").click( function () {                                 return $.ajax2({ data : { SiteGalleryI18n : {                                                 gallery_id: this.id,                                                lang: $("#SelectListLanguages option:selected").attr('id'),                                                                                     } },                                url:"{url_to('site_gallery_ajax',['action'=>'ListPartialPictureForGalleryI18n'])}",                                target: "#actions"});            });                                                               $(".ChangeIsActive").click( function () {                                 return $.ajax2({ data: { SiteGallery : { id: $(this).attr('id'), value: $(this).attr('name'), token: '{mfForm::getToken("ChangeForm")}' } },                                 url: "{url_to('site_gallery_ajax',['action'=>'ChangeIsActiveGallery'])}",                                 success: function(resp) {                                               if (resp.action!='ChangeIsActiveGallery') return ;                                                    change('ChangeIsActive',resp.id,resp.is_active);                                          }                });                });                                                                                                 $(".Delete").click( function () {                 if (!confirm('{__("Gallery \"#0#\" will be deleted. Confirm ?")}'.format(this.name))) return false;                 return $.ajax2({ data :{ SiteGallery: this.id },                                 url :"{url_to('site_gallery_ajax',['action'=>'DeleteGallery'])}",                                 success : function(resp) {                                       if (resp.action!='DeleteGallery') return ;                                       {                                              $(".list[id="+resp.id+"]").remove();                                            if ($('.galleries').length==0)                                              return updateFilter();                                          updatePager(1);                                        }                                        }                     });                                     });              $("#New").click( function () {                            return $.ajax2({                    data : { lang : { lang: $("#SelectListLanguages option:selected").attr('id'),token: "{mfForm::getToken('LanguageFrontendForm')}" } },                                    url: "{url_to('site_gallery_ajax',['action'=>'NewGalleryI18n'])}",                    target: "#actions"               });          });                           $(".selection,#all").click(function (){                               $(".actions_items").css('opacity',($(".selection:checked").length?'1':'0.5'));            });                        $("#Delete").click( function () {              var params={ Selection : {  } };             text="";             $(".selection:checked").each(function (id) {                 params.selection[id]=this.name;                text+=this.id+",\n";             });             if ($.isEmptyObject(params.selection))                return ;             if (!confirm("{__('Gallery :\u000A\u000A\"#0#\"\u000A\u000A will be deleted. Confirm ?')}".format(text.substring(0,text.lastIndexOf(",")))))                  return false;              return $.ajax2({ data :params,                              url: "{url_to('site_gallery_ajax',['action'=>'DeletesGallery'])}",                              success: function(resp) {                                            if (resp.action=='DeletesGallery')                                            {                                                                                    if ($(".galleries").length-resp.parameters.length==0)                                                   return updateFilter();                                                $.each(resp.parameters, function (id) {  $("tr#picture-"+this).remove(); });                                                updatePager(resp.parameters.length);                                                 $("input#all").attr("checked",false);                                                                                }                                     }             });           });                         $(".Copy").click(function () {                       var params = {                            SiteGalleryCopy: {                               languages: [],                               selected : [$(this).attr('id')],                               token : '{mfForm::getToken('CopyGalleriesForm')}'                            }                                                            };          $(".DialogLanguagesFrontend.Checkbox:checked").each(function () { params.GalleryCopy.languages.push($(this).attr('id')); });          return $.ajax2({ data : params,                            url:"{url_to('site_gallery_ajax',['action'=>'CopyGalleries'])}",                            success : function (resp)                                {                                }                });                 });                            $("#Copy").click(function () {               var params = {                             SiteGalleryCopy: {                                languages: [],                                selected : [],                                token : '{mfForm::getToken('CopyGalleriesForm')}'                            }                                                            };             $(".DialogLanguagesFrontend.Checkbox:checked").each(function () { params.GalleryCopy.languages.push($(this).attr('id')); });             $(".selection:checked").each(function () { if ($(this).attr('data-id')) { params.GalleryCopy.selected.push($(this).attr('data-id')); } });              return $.ajax2({ data : params,                            url:"{url_to('site_gallery_ajax',['action'=>'CopyGalleries'])}",                            success : function (resp)                                {                                    $(".selection").prop('checked',false);                                }                });        });           </script>